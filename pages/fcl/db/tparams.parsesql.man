.\" file autogenerated by fpman
.TH "fp-tparams.parsesql" 3 "2014-03-14" "fpman" "Free Pascal Programmer's Manual"
.SH NAME
TParams.ParseSQL - Parse SQL statement, replacing parameter names with SQL parameter placeholders
.SH LOCATION
package \fBfcl\fR, unit \fBdb\fR
.SH SYNOPSIS
public function \fBTParams.ParseSQL\fR(SQL:string; DoCreate:Boolean):string;

function \fBTParams.ParseSQL\fR(SQL:string; DoCreate:Boolean; EscapeSlash:Boolean; EscapeRepeat:Boolean; ParameterStyle:TParamStyle):string;

function \fBTParams.ParseSQL\fR(SQL:string; DoCreate:Boolean; EscapeSlash:Boolean; EscapeRepeat:Boolean; ParameterStyle:TParamStyle; \fBout\fR ParamBinding:TParamBinding):string;

function \fBTParams.ParseSQL\fR(SQL:string; DoCreate:Boolean; EscapeSlash:Boolean; EscapeRepeat:Boolean; ParameterStyle:TParamStyle; \fBout\fR ParamBinding:TParamBinding; \fBout\fR ReplaceString:string):string;
.SH DESCRIPTION
\fBParseSQl\fR parses the \fBSQL\fR statement for parameter names in the form \fB:ParamName\fR. It replaces them with a SQL parameter placeholder. If \fBDoCreate\fR is \fBTrue\fR then a \fBTParam\fR instance is added to the collection with the found parameter name.

The parameter placeholder is determined by the \fBParameterStyle\fR property, which can have the following values:

.TP
.B psInterbase
Parameters are specified by a ? character
.TP
.B psPostgreSQL
Parameters are specified by a $N character.
.TP
.B psSimulated
Parameters are specified by a $N character.
.TP 0
\fBpsInterbase\fR is the default.

If the \fBEscapeSlash\fR parameter is \fBTrue\fR, then backslash characters are used to quote the next character in the SQL statement. If it is \fBFalse\fR, the backslash character is regarded as a normal character.

If the \fBEscapeRepeat\fR parameter is \fBTrue\fR (the default) then embedded quotes in string literals are escaped by repeating themselves. If it is \fBfalse\fR then they should be quoted with backslashes.

\fBParamBinding\fR, if specified, is filled with the indexes of the parameter instances in the parameter collection: for each SQL parameter placeholder, the index of the corresponding \fBTParam\fR instance is returned in the array.

\fBReplaceString\fR, if specified, contains the placeholder used for the parameter names (by default, $). It has effect only when \fBParameterStyle\fR equals \fBpsSimulated\fR.

The function returns the SQL statement with the parameter names replaced by placeholders.


.SH SEE ALSO
.TP
.B TParam
Parameter description class
.TP
.B TParam.Name
Name of the parameter
.TP
.B TParamStyle
Style of parameter

.SH FPMAN
manpage autogenerated by \fIfpman\fR from \fBtparams.parsesql.html\fR on 2015-04-09, 22:10.

